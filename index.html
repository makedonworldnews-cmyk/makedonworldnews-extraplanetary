<!DOCTYPE html>
<html lang="mk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAKEDON WORLD NEWS | Shield Protocol</title>
    <style>
        :root { --gold: #d4af37; --bg: #05070a; --panel: #0f1218; }
        body { background: var(--bg); color: #e2e8f0; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; }
        header { border-bottom: 2px solid var(--gold); padding: 20px; text-align: center; background: var(--panel); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; padding: 20px 0; }
        .card { background: var(--panel); border: 1px solid #1e293b; padding: 15px; border-radius: 8px; transition: 0.3s; cursor: pointer; }
        .card:hover { border-color: var(--gold); transform: translateY(-3px); }
        .meta { color: var(--gold); font-size: 0.75rem; font-weight: bold; margin-bottom: 10px; display: block; }
        h3 { font-size: 1.1rem; margin: 5px 0; line-height: 1.4; }
        p { color: #94a3b8; font-size: 0.9rem; }
        #status-bar { font-family: monospace; font-size: 0.8rem; color: #64748b; margin-top: 10px; }
        .error-msg { color: #ef4444; font-size: 0.8rem; }
    </style>
</head>
<body>

<header>
    <h1 style="margin:0; letter-spacing:2px;">MAKEDON WORLD NEWS</h1>
    <div id="status-bar">
        STATUS: <span id="sys-stat" style="color:var(--gold)">INITIALIZING...</span> | 
        FOUND: <span id="news-count">0</span>
    </div>
</header>

<div id="news-grid" class="grid">
    <div style="grid-column: 1/-1; text-align: center; padding: 50px;">
        üì° –í–†–®–ò–¢–ï –°–ö–ï–ù–ò–†–ê–ä–ï –ù–ê –ì–õ–û–ë–ê–õ–ù–ò–¢–ï RSS –§–†–ï–ö–í–ï–ù–¶–ò–ò...
    </div>
</div>

<script>
    // –ö–æ—Ä–∏—Å—Ç–∏–º–µ –Ω–æ–≤, –ø–æ—Å–∏–≥—É—Ä–µ–Ω –ø—Ä–æ–∫—Å–∏ –º–µ—Ç–æ–¥
    const SOURCES = [
        { name: "Sitel", url: "https://www.sitel.com.mk/feed" },
        { name: "MIA", url: "https://www.mia.mk/rss" },
        { name: "Telma", url: "https://telma.com.mk/feed" },
        { name: "BBC News", url: "https://feeds.bbci.co.uk/news/world/rss.xml" }
    ];

    // –û–±–∏–¥ —Å–æ –Ω–µ–∫–æ–ª–∫—É —Ä–∞–∑–ª–∏—á–Ω–∏ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∏ –∞–∫–æ –µ–¥–Ω–∏–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∏
    const PROXIES = [
        "https://api.allorigins.win/get?url=",
        "https://corsproxy.io/?",
        "https://thingproxy.freeboard.io/fetch/"
    ];

    async function fetchWithFallback(targetUrl) {
        // –ü—Ä–≤–æ –ø—Ä–æ–±—É–≤–∞–º–µ —Å–æ corsproxy.io (–Ω–∞—ò—Å—Ç–∞–±–∏–ª–µ–Ω –∑–∞ GitHub)
        try {
            const response = await fetch("https://corsproxy.io/?" + encodeURIComponent(targetUrl));
            if (!response.ok) throw new Error();
            return await response.text();
        } catch (e) {
            // –ê–∫–æ –Ω–µ —Ä–∞–±–æ—Ç–∏, –ø—Ä–æ–±—É–≤–∞–º–µ —Å–æ AllOrigins
            const res = await fetch("https://api.allorigins.win/get?url=" + encodeURIComponent(targetUrl));
            const json = await res.json();
            return json.contents;
        }
    }

    async function startSystem() {
        const grid = document.getElementById('news-grid');
        const countEl = document.getElementById('news-count');
        const statEl = document.getElementById('sys-stat');
        let totalArticles = [];

        for (let src of SOURCES) {
            try {
                const xmlContent = await fetchWithFallback(src.url);
                const parser = new DOMParser();
                const xml = parser.parseFromString(xmlContent, "text/xml");
                const items = xml.querySelectorAll("item");

                items.forEach((item, i) => {
                    if (i < 5) {
                        totalArticles.push({
                            title: item.querySelector("title")?.textContent || "Breaking News",
                            link: item.querySelector("link")?.textContent || "#",
                            desc: item.querySelector("description")?.textContent?.replace(/<[^>]*>?/gm, '').substring(0, 100),
                            source: src.name
                        });
                    }
                });
                
                // –ê–∂—É—Ä–∏—Ä–∞—ò –≤–µ–¥–Ω–∞—à –∑–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç –¥–∞ –≥–ª–µ–¥–∞ –Ω–∞–ø—Ä–µ–¥–æ–∫
                countEl.innerText = totalArticles.length;
                render(totalArticles);
                
            } catch (err) {
                console.log("Failed source: " + src.name);
            }
        }

        statEl.innerText = "SATELLITE LINK STABLE";
        statEl.style.color = "#22c55e";
    }

    function render(data) {
        const grid = document.getElementById('news-grid');
        if (data.length === 0) return;
        
        grid.innerHTML = data.map(a => `
            <div class="card" onclick="window.open('${a.link}', '_blank')">
                <span class="meta">${a.source}</span>
                <h3>${a.title}</h3>
                <p>${a.desc}...</p>
            </div>
        `).join('');
    }

    window.onload = startSystem;
</script>

</body>
</html>
